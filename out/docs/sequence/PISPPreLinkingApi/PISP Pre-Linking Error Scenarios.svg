<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1670px" preserveAspectRatio="none" style="width:1659px;height:1670px;" version="1.1" viewBox="0 0 1659 1670" width="1659px" zoomAndPan="magnify"><defs><filter height="300%" id="f1ltgo9ulyoqqa" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacing" textLength="287" x="682.5" y="28.708">PISP Pre-Linking Error Scenarios</text><rect fill="#DDDDDD" height="1623.2266" style="stroke:#A80036;stroke-width:1.0;" width="826.5" x="445.5" y="40.9531"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="180" x="768.75" y="53.02">PISP tp-scheme-adapter</text><rect fill="#DDDDDD" height="1623.2266" style="stroke:#A80036;stroke-width:1.0;" width="73" x="1569" y="40.9531"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="67" x="1572" y="53.02">Mojaloop</text><rect fill="#FFFFFF" filter="url(#f1ltgo9ulyoqqa)" height="1438.2344" style="stroke:#A80036;stroke-width:1.0;" width="10" x="56.5" y="169.6484"/><rect fill="#FFFFFF" filter="url(#f1ltgo9ulyoqqa)" height="1438.2344" style="stroke:#A80036;stroke-width:1.0;" width="10" x="511.5" y="169.6484"/><rect fill="#FFFFFF" filter="url(#f1ltgo9ulyoqqa)" height="100.3984" style="stroke:#A80036;stroke-width:1.0;" width="10" x="832.5" y="274.0469"/><rect fill="#FFFFFF" filter="url(#f1ltgo9ulyoqqa)" height="213.1953" style="stroke:#A80036;stroke-width:1.0;" width="10" x="832.5" y="624.9063"/><rect fill="#FFFFFF" filter="url(#f1ltgo9ulyoqqa)" height="213.1953" style="stroke:#A80036;stroke-width:1.0;" width="10" x="832.5" y="1241.625"/><rect fill="#FFFFFF" filter="url(#f1ltgo9ulyoqqa)" height="250.4609" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1201.5" y="374.4453"/><rect fill="#FFFFFF" filter="url(#f1ltgo9ulyoqqa)" height="250.4609" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1201.5" y="991.1641"/><rect fill="#FFFFFF" filter="url(#f1ltgo9ulyoqqa)" height="1271.5703" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1600.5" y="345.3125"/><rect fill="#FFFFFF" filter="url(#f1ltgo9ulyoqqa)" height="221.3281" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1605.5" y="374.4453"/><rect fill="#FFFFFF" filter="url(#f1ltgo9ulyoqqa)" height="221.3281" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1605.5" y="991.1641"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="61" x2="61" y1="95.3828" y2="1625.8828"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="516.5" x2="516.5" y1="95.3828" y2="1625.8828"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="837.5" x2="837.5" y1="95.3828" y2="1625.8828"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="1206" x2="1206" y1="95.3828" y2="1625.8828"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="1605" x2="1605" y1="95.3828" y2="1625.8828"/><rect fill="#FEFECE" filter="url(#f1ltgo9ulyoqqa)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="109" x="5" y="60.0859"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="95" x="12" y="80.0811">PISP Backend</text><rect fill="#FEFECE" filter="url(#f1ltgo9ulyoqqa)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="109" x="5" y="1624.8828"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="95" x="12" y="1644.8779">PISP Backend</text><rect fill="#FEFECE" filter="url(#f1ltgo9ulyoqqa)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="130" x="449.5" y="60.0859"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="116" x="456.5" y="80.0811">outbound-server</text><rect fill="#FEFECE" filter="url(#f1ltgo9ulyoqqa)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="130" x="449.5" y="1624.8828"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="116" x="456.5" y="1644.8779">outbound-server</text><rect fill="#FEFECE" filter="url(#f1ltgo9ulyoqqa)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="144" x="763.5" y="60.0859"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="130" x="770.5" y="80.0811">PISPrelinkingModel</text><rect fill="#FEFECE" filter="url(#f1ltgo9ulyoqqa)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="144" x="763.5" y="1624.8828"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="130" x="770.5" y="1644.8779">PISPrelinkingModel</text><rect fill="#FEFECE" filter="url(#f1ltgo9ulyoqqa)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="119" x="1145" y="60.0859"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="105" x="1152" y="80.0811">inbound-server</text><rect fill="#FEFECE" filter="url(#f1ltgo9ulyoqqa)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="119" x="1145" y="1624.8828"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="105" x="1152" y="1644.8779">inbound-server</text><rect fill="#FEFECE" filter="url(#f1ltgo9ulyoqqa)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="59" x="1574" y="60.0859"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="45" x="1581" y="80.0811">Switch</text><rect fill="#FEFECE" filter="url(#f1ltgo9ulyoqqa)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="59" x="1574" y="1624.8828"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="45" x="1581" y="1644.8779">Switch</text><rect fill="#FFFFFF" filter="url(#f1ltgo9ulyoqqa)" height="1438.2344" style="stroke:#A80036;stroke-width:1.0;" width="10" x="56.5" y="169.6484"/><rect fill="#FFFFFF" filter="url(#f1ltgo9ulyoqqa)" height="1438.2344" style="stroke:#A80036;stroke-width:1.0;" width="10" x="511.5" y="169.6484"/><rect fill="#FFFFFF" filter="url(#f1ltgo9ulyoqqa)" height="100.3984" style="stroke:#A80036;stroke-width:1.0;" width="10" x="832.5" y="274.0469"/><rect fill="#FFFFFF" filter="url(#f1ltgo9ulyoqqa)" height="213.1953" style="stroke:#A80036;stroke-width:1.0;" width="10" x="832.5" y="624.9063"/><rect fill="#FFFFFF" filter="url(#f1ltgo9ulyoqqa)" height="213.1953" style="stroke:#A80036;stroke-width:1.0;" width="10" x="832.5" y="1241.625"/><rect fill="#FFFFFF" filter="url(#f1ltgo9ulyoqqa)" height="250.4609" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1201.5" y="374.4453"/><rect fill="#FFFFFF" filter="url(#f1ltgo9ulyoqqa)" height="250.4609" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1201.5" y="991.1641"/><rect fill="#FFFFFF" filter="url(#f1ltgo9ulyoqqa)" height="1271.5703" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1600.5" y="345.3125"/><rect fill="#FFFFFF" filter="url(#f1ltgo9ulyoqqa)" height="221.3281" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1605.5" y="374.4453"/><rect fill="#FFFFFF" filter="url(#f1ltgo9ulyoqqa)" height="221.3281" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1605.5" y="991.1641"/><rect fill="#EEEEEE" filter="url(#f1ltgo9ulyoqqa)" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1652" x="0" y="125.9492"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1652" y1="125.9492" y2="125.9492"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1652" y1="128.9492" y2="128.9492"/><rect fill="#EEEEEE" filter="url(#f1ltgo9ulyoqqa)" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="102" x="775" y="115.3828"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="83" x="781" y="131.4497">Pre-Linking</text><polygon fill="#A80036" points="499.5,165.6484,509.5,169.6484,499.5,173.6484,503.5,169.6484" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="66.5" x2="505.5" y1="169.6484" y2="169.6484"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="102" x="73.5" y="164.5825">PRELINKING-1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="136" x="179.5" y="164.5825">GET /linking/providers</text><line style="stroke:#A80036;stroke-width:1.0;" x1="521.5" x2="563.5" y1="198.7813" y2="198.7813"/><line style="stroke:#A80036;stroke-width:1.0;" x1="563.5" x2="563.5" y1="198.7813" y2="211.7813"/><line style="stroke:#A80036;stroke-width:1.0;" x1="522.5" x2="563.5" y1="211.7813" y2="211.7813"/><polygon fill="#A80036" points="532.5,207.7813,522.5,211.7813,532.5,215.7813,528.5,211.7813" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="102" x="528.5" y="193.7153">PRELINKING-2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="186" x="634.5" y="193.7153">const model = await create()</text><rect fill="#FBFB77" filter="url(#f1ltgo9ulyoqqa)" height="23" style="stroke:#A80036;stroke-width:1.0;" width="79" x="526" y="224.7813"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="71" x="530" y="240.8481">state: start</text><polygon fill="#A80036" points="820.5,270.0469,830.5,274.0469,820.5,278.0469,824.5,274.0469" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="521.5" x2="826.5" y1="274.0469" y2="274.0469"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="102" x="528.5" y="268.981">PRELINKING-3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="134" x="634.5" y="268.981">model.getProviders()</text><line style="stroke:#A80036;stroke-width:1.0;" x1="842.5" x2="884.5" y1="303.1797" y2="303.1797"/><line style="stroke:#A80036;stroke-width:1.0;" x1="884.5" x2="884.5" y1="303.1797" y2="316.1797"/><line style="stroke:#A80036;stroke-width:1.0;" x1="843.5" x2="884.5" y1="316.1797" y2="316.1797"/><polygon fill="#A80036" points="853.5,312.1797,843.5,316.1797,853.5,320.1797,849.5,316.1797" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="102" x="849.5" y="298.1138">PRELINKING-4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="239" x="955.5" y="298.1138">ThirdpartyRequests.getServicesById()</text><polygon fill="#A80036" points="1588.5,341.3125,1598.5,345.3125,1588.5,349.3125,1592.5,345.3125" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="842.5" x2="1594.5" y1="345.3125" y2="345.3125"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="102" x="849.5" y="340.2466">PRELINKING-5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="214" x="955.5" y="340.2466">GET /services/THIRD_PARTY_DFSP</text><polygon fill="#A80036" points="848.5,370.4453,838.5,374.4453,848.5,378.4453,844.5,374.4453" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="842.5" x2="1604.5" y1="374.4453" y2="374.4453"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="102" x="854.5" y="369.3794">PRELINKING-6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="88" x="960.5" y="369.3794">202 Accepted</text><path d="M20,387.4453 L20,412.4453 L1647,412.4453 L1647,397.4453 L1637,387.4453 L20,387.4453 " fill="#FBFB77" filter="url(#f1ltgo9ulyoqqa)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M1637,387.4453 L1637,397.4453 L1647,397.4453 L1637,387.4453 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="296" x="679" y="404.5122">ERROR_SCENARIO: Switch receives 7201 error.</text><polygon fill="#A80036" points="1222.5,438.7109,1212.5,442.7109,1222.5,446.7109,1218.5,442.7109" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1216.5" x2="1604.5" y1="442.7109" y2="442.7109"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="102" x="1228.5" y="437.645">PRELINKING-7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="249" x="1334.5" y="437.645">PUT /services/THIRD_PARTY_DFSP/error</text><rect fill="#F08080" filter="url(#f1ltgo9ulyoqqa)" height="113" style="stroke:#A80036;stroke-width:1.0;" width="348" x="1247" y="455.7109"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="249" x="1251" y="471.7778">PUT /services/THIRD_PARTY_DFSP/error</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="1251" y="486.9106">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120" x="1259" y="502.0435">errorInformation: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="114" x="1267" y="517.1763">errorCode: '7201',</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="324" x="1267" y="532.3091">errorDescription: 'No thirdparty enabled FSP found'</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="1259" y="547.4419">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="1251" y="562.5747">}</text><polygon fill="#A80036" points="1588.5,591.7734,1598.5,595.7734,1588.5,599.7734,1592.5,595.7734" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1211.5" x2="1594.5" y1="595.7734" y2="595.7734"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="102" x="1218.5" y="590.7075">PRELINKING-8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="46" x="1324.5" y="590.7075">200 OK</text><polygon fill="#A80036" points="853.5,620.9063,843.5,624.9063,853.5,628.9063,849.5,624.9063" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="847.5" x2="1205.5" y1="624.9063" y2="624.9063"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="102" x="859.5" y="619.8403">PRELINKING-9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="203" x="965.5" y="619.8403">ErrorInformationObject received</text><line style="stroke:#A80036;stroke-width:1.0;" x1="842.5" x2="884.5" y1="654.0391" y2="654.0391"/><line style="stroke:#A80036;stroke-width:1.0;" x1="884.5" x2="884.5" y1="654.0391" y2="667.0391"/><line style="stroke:#A80036;stroke-width:1.0;" x1="843.5" x2="884.5" y1="667.0391" y2="667.0391"/><polygon fill="#A80036" points="853.5,663.0391,843.5,667.0391,853.5,671.0391,849.5,667.0391" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="111" x="849.5" y="648.9731">PRELINKING-10</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="110" x="964.5" y="648.9731">throw same error</text><rect fill="#F08080" filter="url(#f1ltgo9ulyoqqa)" height="98" style="stroke:#A80036;stroke-width:1.0;" width="348" x="847" y="680.0391"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="851" y="696.106">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120" x="859" y="711.2388">errorInformation: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="114" x="867" y="726.3716">errorCode: '7201',</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="324" x="867" y="741.5044">errorDescription: 'No thirdparty enabled FSP found'</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="859" y="756.6372">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="851" y="771.77">}</text><rect fill="#FBFB77" filter="url(#f1ltgo9ulyoqqa)" height="23" style="stroke:#A80036;stroke-width:1.0;" width="96" x="847" y="788.8359"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="88" x="851" y="804.9028">state: errored</text><polygon fill="#A80036" points="532.5,834.1016,522.5,838.1016,532.5,842.1016,528.5,838.1016" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="526.5" x2="836.5" y1="838.1016" y2="838.1016"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="111" x="538.5" y="833.0356">PRELINKING-11</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="172" x="653.5" y="833.0356">catch MojaloopFSPIOPError</text><rect fill="#F08080" filter="url(#f1ltgo9ulyoqqa)" height="113" style="stroke:#A80036;stroke-width:1.0;" width="348" x="158" y="851.1016"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="162" y="867.1685">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120" x="170" y="882.3013">errorInformation: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="114" x="178" y="897.4341">errorCode: '7201',</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="324" x="178" y="912.5669">errorDescription: 'No thirdparty enabled FSP found'</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="170" y="927.6997">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="146" x="170" y="942.8325">currentState: "errored"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="162" y="957.9653">}</text><polygon fill="#A80036" points="77.5,987.1641,67.5,991.1641,77.5,995.1641,73.5,991.1641" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="71.5" x2="510.5" y1="991.1641" y2="991.1641"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="111" x="83.5" y="986.0981">PRELINKING-12</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="243" x="198.5" y="986.0981">404 Not Found ErrorInformationObject</text><path d="M20,1004.1641 L20,1029.1641 L1647,1029.1641 L1647,1014.1641 L1637,1004.1641 L20,1004.1641 " fill="#FBFB77" filter="url(#f1ltgo9ulyoqqa)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M1637,1004.1641 L1637,1014.1641 L1647,1014.1641 L1637,1004.1641 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="344" x="655" y="1021.231">ERROR_SCENARIO: Switch sends back any other error.</text><polygon fill="#A80036" points="1222.5,1055.4297,1212.5,1059.4297,1222.5,1063.4297,1218.5,1059.4297" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1216.5" x2="1604.5" y1="1059.4297" y2="1059.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="111" x="1228.5" y="1054.3638">PRELINKING-13</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="249" x="1343.5" y="1054.3638">PUT /services/THIRD_PARTY_DFSP/error</text><rect fill="#F08080" filter="url(#f1ltgo9ulyoqqa)" height="113" style="stroke:#A80036;stroke-width:1.0;" width="268" x="1327" y="1072.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="249" x="1331" y="1088.4966">PUT /services/THIRD_PARTY_DFSP/error</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="1331" y="1103.6294">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120" x="1339" y="1118.7622">errorInformation: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="114" x="1347" y="1133.895">errorCode: '2001',</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="244" x="1347" y="1149.0278">errorDescription: 'Internal server error'</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="1339" y="1164.1606">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="1331" y="1179.2935">}</text><polygon fill="#A80036" points="1588.5,1208.4922,1598.5,1212.4922,1588.5,1216.4922,1592.5,1212.4922" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1211.5" x2="1594.5" y1="1212.4922" y2="1212.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="111" x="1218.5" y="1207.4263">PRELINKING-14</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="46" x="1333.5" y="1207.4263">200 OK</text><polygon fill="#A80036" points="853.5,1237.625,843.5,1241.625,853.5,1245.625,849.5,1241.625" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="847.5" x2="1205.5" y1="1241.625" y2="1241.625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="111" x="859.5" y="1236.5591">PRELINKING-15</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="165" x="974.5" y="1236.5591">Services request received</text><line style="stroke:#A80036;stroke-width:1.0;" x1="842.5" x2="884.5" y1="1270.7578" y2="1270.7578"/><line style="stroke:#A80036;stroke-width:1.0;" x1="884.5" x2="884.5" y1="1270.7578" y2="1283.7578"/><line style="stroke:#A80036;stroke-width:1.0;" x1="843.5" x2="884.5" y1="1283.7578" y2="1283.7578"/><polygon fill="#A80036" points="853.5,1279.7578,843.5,1283.7578,853.5,1287.7578,849.5,1283.7578" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="111" x="849.5" y="1265.6919">PRELINKING-16</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="220" x="964.5" y="1265.6919">throw account linking generic error</text><rect fill="#F08080" filter="url(#f1ltgo9ulyoqqa)" height="98" style="stroke:#A80036;stroke-width:1.0;" width="392" x="847" y="1296.7578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="851" y="1312.8247">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120" x="859" y="1327.9575">errorInformation: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="114" x="867" y="1343.0903">errorCode: '7200',</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="368" x="867" y="1358.2231">errorDescription: 'Generic Thirdparty account linking error'</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="859" y="1373.356">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="851" y="1388.4888">}</text><rect fill="#FBFB77" filter="url(#f1ltgo9ulyoqqa)" height="23" style="stroke:#A80036;stroke-width:1.0;" width="96" x="847" y="1405.5547"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="88" x="851" y="1421.6216">state: errored</text><polygon fill="#A80036" points="532.5,1450.8203,522.5,1454.8203,532.5,1458.8203,528.5,1454.8203" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="526.5" x2="836.5" y1="1454.8203" y2="1454.8203"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="111" x="538.5" y="1449.7544">PRELINKING-17</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="172" x="653.5" y="1449.7544">catch MojaloopFSPIOPError</text><rect fill="#F08080" filter="url(#f1ltgo9ulyoqqa)" height="113" style="stroke:#A80036;stroke-width:1.0;" width="392" x="114" y="1467.8203"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="118" y="1483.8872">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120" x="126" y="1499.02">errorInformation: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="114" x="134" y="1514.1528">errorCode: '7200',</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="368" x="134" y="1529.2856">errorDescription: 'Generic Thirdparty account linking error'</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="126" y="1544.4185">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="146" x="126" y="1559.5513">currentState: "errored"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="118" y="1574.6841">}</text><polygon fill="#A80036" points="72.5,1603.8828,62.5,1607.8828,72.5,1611.8828,68.5,1607.8828" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="66.5" x2="515.5" y1="1607.8828" y2="1607.8828"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="111" x="78.5" y="1602.8169">PRELINKING-18</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="306" x="193.5" y="1602.8169">500 Internal Server Error ErrorInformationObject</text><!--MD5=[cbb703fc3c3d87cb702449c2e04f0d95]
@startuml

title PISP Pre-Linking Error Scenarios

participant "PISP Backend" as PISP
box "PISP tp-scheme-adapter"
  participant "outbound-server" as PISP_TP_OUT
  participant "PISPrelinkingModel" as PISP_PLM
  participant "inbound-server" as PISP_TP_IN
end box
box "Mojaloop"
    participant Switch
end box

== Pre-Linking ==
autonumber 1 "<b>PRELINKING-#</b>"

PISP -> PISP_TP_OUT: GET /linking/providers

activate PISP
activate PISP_TP_OUT

PISP_TP_OUT -> PISP_TP_OUT: const model = await create()
rnote right of PISP_TP_OUT: state: start
PISP_TP_OUT -> PISP_PLM: model.getProviders()

activate PISP_PLM

PISP_PLM -> PISP_PLM: ThirdpartyRequests.getServicesById()
PISP_PLM -> Switch: GET /services/THIRD_PARTY_DFSP

activate Switch
Switch - -> PISP_PLM: 202 Accepted
deactivate PISP_PLM

note over PISP, Switch
  ERROR_SCENARIO: Switch receives 7201 error.
end note

activate PISP_TP_IN
activate Switch

Switch - -> PISP_TP_IN: PUT /services/THIRD_PARTY_DFSP/error
rnote left of Switch #LightCoral
PUT /services/THIRD_PARTY_DFSP/error
{
  errorInformation: {
    errorCode: '7201',
    errorDescription: 'No thirdparty enabled FSP found'
  }
}
end note
PISP_TP_IN - -> Switch: 200 OK

deactivate Switch

PISP_TP_IN -> PISP_PLM: ErrorInformationObject received

deactivate PISP_TP_IN
activate PISP_PLM

PISP_PLM -> PISP_PLM: throw same error
rnote right of PISP_PLM #LightCoral
{
  errorInformation: {
    errorCode: '7201',
    errorDescription: 'No thirdparty enabled FSP found'
  }
}
end note
rnote right of PISP_PLM: state: errored
PISP_PLM -> PISP_TP_OUT: catch MojaloopFSPIOPError

deactivate PISP_PLM
rnote left of PISP_TP_OUT #LightCoral
{
  errorInformation: {
    errorCode: '7201',
    errorDescription: 'No thirdparty enabled FSP found'
  }
  currentState: "errored"
}
end note
PISP_TP_OUT - -> PISP: 404 Not Found ErrorInformationObject


note over PISP, Switch
  ERROR_SCENARIO: Switch sends back any other error.
end note

activate PISP_TP_IN
activate Switch
Switch - -> PISP_TP_IN: PUT /services/THIRD_PARTY_DFSP/error
rnote left of Switch #LightCoral
PUT /services/THIRD_PARTY_DFSP/error
{
  errorInformation: {
    errorCode: '2001',
    errorDescription: 'Internal server error'
  }
}
end note
PISP_TP_IN - -> Switch: 200 OK

deactivate Switch

PISP_TP_IN -> PISP_PLM: Services request received

deactivate PISP_TP_IN
activate PISP_PLM

PISP_PLM -> PISP_PLM: throw account linking generic error
rnote right of PISP_PLM #LightCoral
{
  errorInformation: {
    errorCode: '7200',
    errorDescription: 'Generic Thirdparty account linking error'
  }
}
end note
rnote right of PISP_PLM: state: errored
PISP_PLM -> PISP_TP_OUT: catch MojaloopFSPIOPError

deactivate PISP_PLM
rnote left of PISP_TP_OUT #LightCoral
{
  errorInformation: {
    errorCode: '7200',
    errorDescription: 'Generic Thirdparty account linking error'
  }
  currentState: "errored"
}
end note
PISP_TP_OUT - -> PISP: 500 Internal Server Error ErrorInformationObject

deactivate PISP_TP_OUT
deactivate PISP

@enduml

PlantUML version 1.2021.00(Sun Jan 10 05:25:05 EST 2021)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>