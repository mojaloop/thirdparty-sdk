<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="872px" preserveAspectRatio="none" style="width:1421px;height:872px;" version="1.1" viewBox="0 0 1421 872" width="1421px" zoomAndPan="magnify"><defs><filter height="300%" id="f1dzxb9r1ct6o9" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacing" textLength="145" x="634.5" y="28.708">PISP Pre-Linking</text><rect fill="#DDDDDD" height="825.3125" style="stroke:#A80036;stroke-width:1.0;" width="821.5" x="256.5" y="40.9531"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="180" x="577.25" y="53.02">PISP tp-scheme-adapter</text><rect fill="#DDDDDD" height="825.3125" style="stroke:#A80036;stroke-width:1.0;" width="73" x="1331" y="40.9531"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="67" x="1334" y="53.02">Mojaloop</text><rect fill="#FFFFFF" filter="url(#f1dzxb9r1ct6o9)" height="649.3203" style="stroke:#A80036;stroke-width:1.0;" width="10" x="56.5" y="169.6484"/><rect fill="#FFFFFF" filter="url(#f1dzxb9r1ct6o9)" height="649.3203" style="stroke:#A80036;stroke-width:1.0;" width="10" x="322.5" y="169.6484"/><rect fill="#FFFFFF" filter="url(#f1dzxb9r1ct6o9)" height="100.3984" style="stroke:#A80036;stroke-width:1.0;" width="10" x="638.5" y="274.0469"/><rect fill="#FFFFFF" filter="url(#f1dzxb9r1ct6o9)" height="62.2656" style="stroke:#A80036;stroke-width:1.0;" width="10" x="638.5" y="609.7734"/><rect fill="#FFFFFF" filter="url(#f1dzxb9r1ct6o9)" height="235.3281" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1007.5" y="374.4453"/><rect fill="#FFFFFF" filter="url(#f1dzxb9r1ct6o9)" height="235.3281" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1362.5" y="345.3125"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="61" x2="61" y1="95.3828" y2="827.9688"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="327.5" x2="327.5" y1="95.3828" y2="827.9688"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="643.5" x2="643.5" y1="95.3828" y2="827.9688"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="1012" x2="1012" y1="95.3828" y2="827.9688"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="1367" x2="1367" y1="95.3828" y2="827.9688"/><rect fill="#FEFECE" filter="url(#f1dzxb9r1ct6o9)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="109" x="5" y="60.0859"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="95" x="12" y="80.0811">PISP Backend</text><rect fill="#FEFECE" filter="url(#f1dzxb9r1ct6o9)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="109" x="5" y="826.9688"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="95" x="12" y="846.9639">PISP Backend</text><rect fill="#FEFECE" filter="url(#f1dzxb9r1ct6o9)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="130" x="260.5" y="60.0859"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="116" x="267.5" y="80.0811">outbound-server</text><rect fill="#FEFECE" filter="url(#f1dzxb9r1ct6o9)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="130" x="260.5" y="826.9688"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="116" x="267.5" y="846.9639">outbound-server</text><rect fill="#FEFECE" filter="url(#f1dzxb9r1ct6o9)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="144" x="569.5" y="60.0859"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="130" x="576.5" y="80.0811">PISPrelinkingModel</text><rect fill="#FEFECE" filter="url(#f1dzxb9r1ct6o9)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="144" x="569.5" y="826.9688"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="130" x="576.5" y="846.9639">PISPrelinkingModel</text><rect fill="#FEFECE" filter="url(#f1dzxb9r1ct6o9)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="119" x="951" y="60.0859"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="105" x="958" y="80.0811">inbound-server</text><rect fill="#FEFECE" filter="url(#f1dzxb9r1ct6o9)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="119" x="951" y="826.9688"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="105" x="958" y="846.9639">inbound-server</text><rect fill="#FEFECE" filter="url(#f1dzxb9r1ct6o9)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="59" x="1336" y="60.0859"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="45" x="1343" y="80.0811">Switch</text><rect fill="#FEFECE" filter="url(#f1dzxb9r1ct6o9)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="59" x="1336" y="826.9688"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="45" x="1343" y="846.9639">Switch</text><rect fill="#FFFFFF" filter="url(#f1dzxb9r1ct6o9)" height="649.3203" style="stroke:#A80036;stroke-width:1.0;" width="10" x="56.5" y="169.6484"/><rect fill="#FFFFFF" filter="url(#f1dzxb9r1ct6o9)" height="649.3203" style="stroke:#A80036;stroke-width:1.0;" width="10" x="322.5" y="169.6484"/><rect fill="#FFFFFF" filter="url(#f1dzxb9r1ct6o9)" height="100.3984" style="stroke:#A80036;stroke-width:1.0;" width="10" x="638.5" y="274.0469"/><rect fill="#FFFFFF" filter="url(#f1dzxb9r1ct6o9)" height="62.2656" style="stroke:#A80036;stroke-width:1.0;" width="10" x="638.5" y="609.7734"/><rect fill="#FFFFFF" filter="url(#f1dzxb9r1ct6o9)" height="235.3281" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1007.5" y="374.4453"/><rect fill="#FFFFFF" filter="url(#f1dzxb9r1ct6o9)" height="235.3281" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1362.5" y="345.3125"/><rect fill="#EEEEEE" filter="url(#f1dzxb9r1ct6o9)" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1414" x="0" y="125.9492"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1414" y1="125.9492" y2="125.9492"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1414" y1="128.9492" y2="128.9492"/><rect fill="#EEEEEE" filter="url(#f1dzxb9r1ct6o9)" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="102" x="656" y="115.3828"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="83" x="662" y="131.4497">Pre-Linking</text><polygon fill="#A80036" points="310.5,165.6484,320.5,169.6484,310.5,173.6484,314.5,169.6484" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="66.5" x2="316.5" y1="169.6484" y2="169.6484"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="102" x="73.5" y="164.5825">PRELINKING-1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="136" x="179.5" y="164.5825">GET /linking/providers</text><line style="stroke:#A80036;stroke-width:1.0;" x1="332.5" x2="374.5" y1="198.7813" y2="198.7813"/><line style="stroke:#A80036;stroke-width:1.0;" x1="374.5" x2="374.5" y1="198.7813" y2="211.7813"/><line style="stroke:#A80036;stroke-width:1.0;" x1="333.5" x2="374.5" y1="211.7813" y2="211.7813"/><polygon fill="#A80036" points="343.5,207.7813,333.5,211.7813,343.5,215.7813,339.5,211.7813" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="102" x="339.5" y="193.7153">PRELINKING-2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="186" x="445.5" y="193.7153">const model = await create()</text><rect fill="#FBFB77" filter="url(#f1dzxb9r1ct6o9)" height="23" style="stroke:#A80036;stroke-width:1.0;" width="79" x="337" y="224.7813"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="71" x="341" y="240.8481">state: start</text><polygon fill="#A80036" points="626.5,270.0469,636.5,274.0469,626.5,278.0469,630.5,274.0469" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="332.5" x2="632.5" y1="274.0469" y2="274.0469"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="102" x="339.5" y="268.981">PRELINKING-3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="134" x="445.5" y="268.981">model.getProviders()</text><line style="stroke:#A80036;stroke-width:1.0;" x1="648.5" x2="690.5" y1="303.1797" y2="303.1797"/><line style="stroke:#A80036;stroke-width:1.0;" x1="690.5" x2="690.5" y1="303.1797" y2="316.1797"/><line style="stroke:#A80036;stroke-width:1.0;" x1="649.5" x2="690.5" y1="316.1797" y2="316.1797"/><polygon fill="#A80036" points="659.5,312.1797,649.5,316.1797,659.5,320.1797,655.5,316.1797" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="102" x="655.5" y="298.1138">PRELINKING-4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="239" x="761.5" y="298.1138">ThirdpartyRequests.getServicesById()</text><polygon fill="#A80036" points="1350.5,341.3125,1360.5,345.3125,1350.5,349.3125,1354.5,345.3125" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="648.5" x2="1356.5" y1="345.3125" y2="345.3125"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="102" x="655.5" y="340.2466">PRELINKING-5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="214" x="761.5" y="340.2466">GET /services/THIRD_PARTY_DFSP</text><polygon fill="#A80036" points="654.5,370.4453,644.5,374.4453,654.5,378.4453,650.5,374.4453" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="648.5" x2="1361.5" y1="374.4453" y2="374.4453"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="102" x="660.5" y="369.3794">PRELINKING-6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="88" x="766.5" y="369.3794">202 Accepted</text><path d="M20,387.4453 L20,412.4453 L1409,412.4453 L1409,397.4453 L1399,387.4453 L20,387.4453 " fill="#FBFB77" filter="url(#f1dzxb9r1ct6o9)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M1399,387.4453 L1399,397.4453 L1409,397.4453 L1399,387.4453 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="322" x="547" y="404.5122">HAPPY_SCENARIO: Switch returns a non-empty list</text><polygon fill="#A80036" points="1028.5,438.7109,1018.5,442.7109,1028.5,446.7109,1024.5,442.7109" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1022.5" x2="1361.5" y1="442.7109" y2="442.7109"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="102" x="1034.5" y="437.645">PRELINKING-7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="214" x="1140.5" y="437.645">PUT /services/THIRD_PARTY_DFSP</text><rect fill="#ADD8E6" filter="url(#f1dzxb9r1ct6o9)" height="98" style="stroke:#A80036;stroke-width:1.0;" width="222" x="1135" y="455.7109"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="214" x="1139" y="471.7778">PUT /services/THIRD_PARTY_DFSP</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="1139" y="486.9106">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="72" x="1147" y="502.0435">providers: [</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="98" x="1155" y="517.1763">"dfspa", "dfspb"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="5" x="1147" y="532.3091">]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="1139" y="547.4419">}</text><polygon fill="#A80036" points="1355.5,576.6406,1365.5,580.6406,1355.5,584.6406,1359.5,580.6406" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1017.5" x2="1361.5" y1="580.6406" y2="580.6406"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="102" x="1024.5" y="575.5747">PRELINKING-8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="46" x="1130.5" y="575.5747">200 OK</text><polygon fill="#A80036" points="659.5,605.7734,649.5,609.7734,659.5,613.7734,655.5,609.7734" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="653.5" x2="1011.5" y1="609.7734" y2="609.7734"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="102" x="665.5" y="604.7075">PRELINKING-9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="165" x="771.5" y="604.7075">Services request recieved</text><rect fill="#FBFB77" filter="url(#f1dzxb9r1ct6o9)" height="23" style="stroke:#A80036;stroke-width:1.0;" width="207" x="653" y="622.7734"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="199" x="657" y="638.8403">state: providersLookupSuccess</text><polygon fill="#A80036" points="343.5,668.0391,333.5,672.0391,343.5,676.0391,339.5,672.0391" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="337.5" x2="642.5" y1="672.0391" y2="672.0391"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="111" x="349.5" y="666.9731">PRELINKING-10</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102" x="464.5" y="666.9731">return providers</text><rect fill="#ADD8E6" filter="url(#f1dzxb9r1ct6o9)" height="98" style="stroke:#A80036;stroke-width:1.0;" width="281" x="36" y="685.0391"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="40" y="701.106">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="72" x="56" y="716.2388">providers: [</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="98" x="68" y="731.3716">"dfspa", "dfspb"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="9" x="56" y="746.5044">],</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="257" x="56" y="761.6372">currentState: "providersLookupSuccess"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="40" y="776.77">}</text><polygon fill="#A80036" points="77.5,805.9688,67.5,809.9688,77.5,813.9688,73.5,809.9688" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="71.5" x2="321.5" y1="809.9688" y2="809.9688"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="111" x="83.5" y="804.9028">PRELINKING-11</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109" x="198.5" y="804.9028">200 OK Providers</text><!--MD5=[836521c0d4fac32f28e62ede0bbedf19]
@startuml

title PISP Pre-Linking

participant "PISP Backend" as PISP
box "PISP tp-scheme-adapter"
  participant "outbound-server" as PISP_TP_OUT
  participant "PISPrelinkingModel" as PISP_PLM
  participant "inbound-server" as PISP_TP_IN
end box
box "Mojaloop"
    participant Switch
end box

== Pre-Linking ==
autonumber 1 "<b>PRELINKING-#</b>"

PISP -> PISP_TP_OUT: GET /linking/providers

activate PISP
activate PISP_TP_OUT

PISP_TP_OUT -> PISP_TP_OUT: const model = await create()
rnote right of PISP_TP_OUT: state: start
PISP_TP_OUT -> PISP_PLM: model.getProviders()

activate PISP_PLM

PISP_PLM -> PISP_PLM: ThirdpartyRequests.getServicesById()
PISP_PLM -> Switch: GET /services/THIRD_PARTY_DFSP

activate Switch
Switch - -> PISP_PLM: 202 Accepted
deactivate PISP_PLM

note over PISP, Switch
  HAPPY_SCENARIO: Switch returns a non-empty list
end note

activate PISP_TP_IN

Switch - -> PISP_TP_IN: PUT /services/THIRD_PARTY_DFSP
rnote left of Switch #LightBlue
PUT /services/THIRD_PARTY_DFSP
{
  providers: [
    "dfspa", "dfspb"
  ]
}
end note
PISP_TP_IN - -> Switch: 200 OK

deactivate Switch

PISP_TP_IN -> PISP_PLM: Services request recieved

deactivate PISP_TP_IN
activate PISP_PLM

rnote right of PISP_PLM: state: providersLookupSuccess
PISP_PLM -> PISP_TP_OUT: return providers

deactivate PISP_PLM
rnote left of PISP_TP_OUT #LightBlue
{
    providers: [
       "dfspa", "dfspb"
    ],
    currentState: "providersLookupSuccess"
}
end note
PISP_TP_OUT - -> PISP: 200 OK Providers

@enduml

PlantUML version 1.2021.00(Sun Jan 10 05:25:05 EST 2021)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>